{"version":3,"file":"index.js","sources":["../src/main.ts"],"sourcesContent":["import querystring from 'querystring'\n\ntype InitOptions = Partial<{\n    tokenKey: string;\n    target: string;\n    title: string;\n    env: 'development' | 'production'; // production development\n}>\n\nconst ENV = {\n    development: 'development',\n    production: 'production'\n}\n\nclass Login {\n    private target = ''\n    private title = ''\n    private env = ''\n\n    init ({ tokenKey = 'token', target = '_self', title = '登录', env = 'development' }: InitOptions = {}) {\n        this.env = env\n        this.target = target\n        this.title = title\n        const token = querystring.parse(location.search.slice(1)).qm_token as string\n\n        // 路径上存在 token 则设置进local 并且清除掉路径上的 token\n        if (token) {\n            localStorage.setItem(tokenKey, token)\n            history.pushState({}, '', location.href.split('?')[0])\n        } else if (!localStorage.getItem(tokenKey)) {\n            // 本地没有存有token 则登录\n            this.login()\n        }\n    }\n\n    login () {\n        const url = this.env === ENV.development ? 'http://192.168.1.160:8001' : 'https://admin.91xiangju.com/frontend-platform/login'\n        const from = `qm_from=${encodeURIComponent(location.href)}`\n        const title = `&title=${encodeURIComponent(this.title)}`\n        open(`${url}?${from}${title}`, this.target)\n    }\n}\n\nexport default new Login()\n"],"names":["ENV","this","Login","_a","_b","_c","tokenKey","_d","target","_e","title","_f","env","token","querystring","parse","location","search","slice","qm_token","localStorage","setItem","history","pushState","href","split","getItem","login","url","from","encodeURIComponent","open"],"mappings":"2BASA,IAAMA,EACW,gBAiCF,eA7Bf,aACYC,YAAS,GACTA,WAAQ,GACRA,SAAM,GAwBlB,OAtBIC,iBAAA,SAAMC,OAAAC,aAA2F,KAAzFC,aAAAC,aAAW,UAASC,WAAAC,aAAS,UAASC,UAAAC,aAAQ,OAAMC,QAAAC,aAAM,gBAC9DX,KAAKW,IAAMA,EACXX,KAAKO,OAASA,EACdP,KAAKS,MAAQA,EACb,IAAMG,EAAQC,EAAYC,MAAMC,SAASC,OAAOC,MAAM,IAAIC,SAGtDN,GACAO,aAAaC,QAAQf,EAAUO,GAC/BS,QAAQC,UAAU,GAAI,GAAIP,SAASQ,KAAKC,MAAM,KAAK,KAC3CL,aAAaM,QAAQpB,IAE7BL,KAAK0B,SAIbzB,kBAAA,WACI,IAAM0B,EAAM3B,KAAKW,MAAQZ,EAAkB,4BAA8B,sDACnE6B,EAAO,WAAWC,mBAAmBd,SAASQ,MAC9Cd,EAAQ,UAAUoB,mBAAmB7B,KAAKS,OAChDqB,KAAQH,MAAOC,EAAOnB,EAAST,KAAKO"}